---
_env: &env
  - 'MASTORAS_BUILD_ROOT={{ user `mastoras::build_root` }}'
  - 'MASTORAS_SCROLL_NAME={{ user `mastoras::scroll_name` }}'
builders:
  - type: vagrant
    communicator: ssh
provisioners:
  - type: shell
    script: '{{ user `mastoras::mastrinit_local` }}'
    remote_path: '{{ user `mastoras::mastrinit_remote` }}'
    environment_vars: *env
  - type: file
    source: setup.d
    destination: /mastoras/current
  - type: shell
    environment_vars: *env
    inline: |
      bash -x /mastoras/current/setup.d/setup.bash
